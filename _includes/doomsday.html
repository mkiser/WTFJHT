<!-- WTFJHT Government Shutdown Timer -->

{% assign shutdown_date = include.date | default: "Oct 1, 2025 00:01:00 -0400" %}

<div id="shutdown-container" class="shutdown-timer">
    <h2 id="shutdown-status" class="shutdown-status">
        ðŸš¨ Gov't Shutdown Countdown ðŸš¨
    </h2>
    
    <div id="timer-display" class="timer-display">
        <span id="doomsday">00d 00h 00m 00s</span>
    </div>
    
    <p id="impact-message" class="impact-message">
        Federal funding expires in 0 days unless Congress acts
    </p>
</div>

<style>
    /* WTFJHT Shutdown Timer Styles */
    .shutdown-timer {
        background: #222;
        color: #f9f9f9;
        text-align: center;
        margin: 0;
        padding: 1.5rem 1rem;
        border-top: 1px solid #777;
        border-bottom: 1px solid #777;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', Arial, sans-serif;
        min-height: 200px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        box-sizing: border-box;
        -webkit-font-smoothing: antialiased;
    }

    .shutdown-status {
        color: #e74c3c;
        margin: 0 0 1.5rem 0;
        font-size: 1.6rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
        line-height: 1.25;
    }

    .timer-display {
        font-family: Menlo, Monaco, 'Courier New', monospace;
        font-size: 3.5rem;
        font-weight: bold;
        color: #f9f9f9;
        margin: 1rem 0 1.5rem 0;
        letter-spacing: 2px;
        line-height: 1;
    }

    .impact-message {
        color: #767676;
        font-size: 0.85rem;
        margin: 0;
        font-weight: 400;
        line-height: 1.4;
        max-width: 500px;
        word-spacing: 0.1em;
        hyphens: none;
    }

    /* Animation Keyframes */
    @keyframes text-pulse {
        0%, 100% { color: #e74c3c; }
        50% { color: #c0392b; }
    }

    @keyframes urgent-background {
        0%, 100% { 
            background-color: #222;
            border-top-color: #777;
            border-bottom-color: #777;
        }
        50% { 
            background-color: #2a1a1a;
            border-top-color: #e74c3c;
            border-bottom-color: #e74c3c;
        }
    }

    /* State Classes */
    .final-countdown .shutdown-status {
        animation: text-pulse 1s ease-in-out infinite;
    }

    .final-countdown .timer-display {
        color: #e74c3c !important;
    }

    .shutdown-active {
        animation: urgent-background 3s ease-in-out infinite;
    }

    .shutdown-active .shutdown-status {
        animation: text-pulse 2s ease-in-out infinite;
    }

    .shutdown-active .timer-display {
        color: #ff4444 !important;
    }

    /* Responsive Design */
    @media (max-width: 834px) {
        .shutdown-timer {
            min-height: 180px !important;
            padding: 1.2rem 0.5rem !important;
        }
        
        .shutdown-status {
            font-size: 1.4rem !important;
            margin-bottom: 1rem !important;
        }
        
        .timer-display {
            font-size: 2.5rem !important;
            margin: 0.8rem 0 1.2rem 0 !important;
        }
        
        .impact-message {
            font-size: 0.8rem !important;
            max-width: 90% !important;
        }
    }

    @media (max-width: 425px) {
        .timer-display {
            font-size: 2rem !important;
            letter-spacing: 1px !important;
        }
        
        .shutdown-status {
            font-size: 1.2rem !important;
        }
    }
</style>

<script>
(function() {
    'use strict';
    
    /**
     * WTFJHT Government Shutdown Timer
     * Self-contained Jekyll include version
     */
    class ShutdownTimer {
        constructor(shutdownDate) {
            this.shutdownDate = new Date(shutdownDate).getTime();
            this.interval = null;
            this.init();
        }

        init() {
            this.startTimer();
            console.log('âœ… WTFJHT shutdown timer loaded!');
        }

        startTimer() {
            this.interval = setInterval(() => {
                this.updateTimer();
            }, 1000);
            
            // Initial update
            this.updateTimer();
        }

        updateTimer() {
            const now = new Date().getTime();
            const distance = this.shutdownDate - now;
            
            const timeUnits = this.calculateTimeUnits(Math.abs(distance));
            const elements = this.getElements();
            
            if (!elements.container) return;

            if (distance > 0) {
                this.updateCountdownMode(elements, timeUnits, distance);
            } else {
                this.updateShutdownMode(elements, timeUnits);
            }

            this.updateTimerDisplay(timeUnits);
        }

        calculateTimeUnits(absoluteDistance) {
            return {
                days: Math.floor(absoluteDistance / (1000 * 60 * 60 * 24)),
                hours: Math.floor((absoluteDistance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)),
                minutes: Math.floor((absoluteDistance % (1000 * 60 * 60)) / (1000 * 60)),
                seconds: Math.floor((absoluteDistance % (1000 * 60)) / 1000)
            };
        }

        getElements() {
            return {
                container: document.getElementById("shutdown-container"),
                status: document.getElementById("shutdown-status"),
                impact: document.getElementById("impact-message"),
                timer: document.getElementById("doomsday")
            };
        }

        updateCountdownMode(elements, timeUnits, distance) {
            const { container, status, impact } = elements;
            const { days } = timeUnits;

            container.classList.remove("shutdown-active");
            status.innerHTML = "ðŸš¨ Gov't Shutdown Countdown ðŸš¨";

            // Add urgency for final 24 hours
            if (distance < 24 * 60 * 60 * 1000) {
                container.classList.add("final-countdown");
            } else {
                container.classList.remove("final-countdown");
            }

            const dayText = days === 1 ? "day" : "days";
            impact.innerHTML = `Federal funding expires in&nbsp;${days}&nbsp;${dayText} unless Congress&nbsp;acts`;
        }

        updateShutdownMode(elements, timeUnits) {
            const { container, status, impact } = elements;
            const { days } = timeUnits;

            container.classList.add("shutdown-active");
            container.classList.remove("final-countdown");
            
            status.innerHTML = `ðŸ”¥ Gov't Shutdown: Day ${days + 1} ðŸ”¥`;

            if (days === 0) {
                impact.innerHTML = "Government shutdown began&nbsp;today";
            } else {
                const dayText = days === 1 ? "day" : "days";
                impact.innerHTML = `Government shutdown has lasted ${days}&nbsp;${dayText}`;
            }
        }

        updateTimerDisplay(timeUnits) {
            const { days, hours, minutes, seconds } = timeUnits;
            const timerElement = document.getElementById("doomsday");
            
            if (timerElement) {
                timerElement.innerHTML = 
                    `${days}d ${hours.toString().padStart(2, '0')}h ${minutes.toString().padStart(2, '0')}m ${seconds.toString().padStart(2, '0')}s`;
            }
        }

        destroy() {
            if (this.interval) {
                clearInterval(this.interval);
                this.interval = null;
            }
        }
    }

    // Initialize timer when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', function() {
            new ShutdownTimer("{{ shutdown_date }}");
        });
    } else {
        new ShutdownTimer("{{ shutdown_date }}");
    }
})();
</script>
